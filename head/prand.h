#include<time.h>
#define LIBNET_PR2 1
#define LIBNET_PR8 2
#define LIBNET_PR16 3
#define LIBNET_PRu16 4
#define LIBNET_PR32 5
#define LIBNET_PRu32 6

int
libnet_seed_prand()
{
    struct timeval seed;

    if (gettimeofday(&seed, NULL) == -1)
    {
        perror("seed_rand: cannot gettimeofday");
        return (-1);
    }

    /*
     *  More entropy then just seeding with time(2).
     */
    srandom((unsigned)(seed.tv_sec ^ seed.tv_usec));
    return (1);
}


u_long
libnet_get_prand(int mod)
{
    u_long n;

    n = random();

    switch (mod)
    {
        case LIBNET_PR2:
            return (n % 0x2);           /* 0 - 1 */
        case LIBNET_PR8:
            return (n % 0xff);          /* 0 - 255 */
        case LIBNET_PR16:
            return (n % 0x7fff);        /* 0 - 32767 */
        case LIBNET_PRu16:
            return (n % 0xffff);        /* 0 - 65535 */
        case LIBNET_PR32:
            return (n % 0x7fffffff);    /* 0 - 2147483647 */
        case LIBNET_PRu32:
            return (n);                 /* 0 - 4294967295 */
    }
    return (0);                         /* NOTTREACHED */
}

